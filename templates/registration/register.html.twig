{% extends 'base.html.twig' %}

{% block title %}Inscription{% endblock %}

{% block body %}
<div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div class="register-box p-4 rounded shadow bg-white w-50 border border-dark">

        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }} mt-2">{{ message }}</div>
            {% endfor %}
        {% endfor %}


        <h2 class="text-center mb-4">S'inscrire</h2>

        {{ form_start(registrationForm) }}

        <!-- ✅ Affiche les erreurs globales du formulaire -->
        {{ form_errors(registrationForm) }}

        <div class="form-group">
            {{ form_label(registrationForm.username, 'Nom utilisateur :') }}
            {{ form_widget(registrationForm.username, {'attr': {'class': 'form-control'}}) }}
            {% for error in registrationForm.username.vars.errors %}
                <div class="text-danger">{{ error.message }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form_label(registrationForm.email, 'Adresse mail :') }}
            {{ form_widget(registrationForm.email, {'attr': {'class': 'form-control'}}) }}
            {% for error in registrationForm.email.vars.errors %}
                <div class="text-danger">{{ error.message }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form_label(registrationForm.address, 'Adresse de livraison :') }}
            {{ form_widget(registrationForm.address, {'attr': {'class': 'form-control'}}) }}
            {% for error in registrationForm.address.vars.errors %}
                <div class="text-danger">{{ error.message }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form_label(registrationForm.plainPassword, 'Mot de passe :') }}
            {{ form_widget(registrationForm.plainPassword, {'attr': {'class': 'form-control'}}) }}
            
            <!-- ✅ Ajout des messages d'erreur sous le champ mot de passe -->
            {% for error in registrationForm.plainPassword.vars.errors %}
                <div class="text-danger">{{ error.message }}</div>
            {% endfor %}
        </div>

        <button type="submit" class="btn btn-primary w-100 mt-3">Créer un compte</button>

        {{ form_end(registrationForm) }}

        <div class="divider my-3"></div>
        <div class="already-registered text-center">
            <p>Déjà inscrit ?</p>
            <a href="{{ path('app_login') }}" class="btn btn-secondary w-100">Se Connecter</a>
        </div>
    </div>
</div>
{% endblock %}

